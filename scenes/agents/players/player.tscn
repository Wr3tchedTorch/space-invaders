[gd_scene load_steps=15 format=3 uid="uid://4oqb4vuw77as"]

[ext_resource type="Script" uid="uid://bi4t7f2cuoenm" path="res://scenes/agents/players/Player.cs" id="1_y3jks"]
[ext_resource type="Texture2D" uid="uid://bmxl3pgpljhj0" path="res://assets/sprites/player/player.png" id="2_fovvg"]
[ext_resource type="PackedScene" uid="uid://cpk4vtnxsnii2" path="res://scenes/components/weapon_component.tscn" id="2_ok5fs"]
[ext_resource type="Resource" uid="uid://cfun7wpw0no6x" path="res://assets/resources/weapon/player/player_giant_gun.tres" id="3_8nvt7"]
[ext_resource type="PackedScene" uid="uid://c6wup6v31n5as" path="res://scenes/components/health_component.tscn" id="4_vjyvw"]
[ext_resource type="PackedScene" uid="uid://e143nu2c0qss" path="res://scenes/managers/marker_manager.tscn" id="5_mws0h"]
[ext_resource type="PackedScene" uid="uid://dpxn2hvqockmm" path="res://scenes/components/hurtbox_component.tscn" id="5_uoiam"]
[ext_resource type="Texture2D" uid="uid://cbads1qnmannx" path="res://assets/sprites/player/player-explosion3.png" id="6_8nvt7"]
[ext_resource type="Texture2D" uid="uid://daw8ljucicyqv" path="res://assets/sprites/player/player-explosion2.png" id="7_w6byd"]
[ext_resource type="PackedScene" uid="uid://bifi08dxhq6gj" path="res://scenes/ui/ammunition_bar.tscn" id="8_g6hfa"]
[ext_resource type="Texture2D" uid="uid://csagqenytngpq" path="res://assets/sprites/player/player-explosion1.png" id="8_yiiiv"]

[sub_resource type="SpriteFrames" id="SpriteFrames_highs"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("6_8nvt7")
}, {
"duration": 1.0,
"texture": ExtResource("7_w6byd")
}, {
"duration": 1.0,
"texture": ExtResource("8_yiiiv")
}],
"loop": false,
"name": &"death",
"speed": 8.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_fovvg")
}],
"loop": true,
"name": &"default",
"speed": 0.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_y3jks"]
size = Vector2(13, 5)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_vjyvw"]
size = Vector2(13, 5)

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("CollisionShape2D", "WeaponComponent", "HealthComponent", "AnimatedSprite2D")]
collision_mask = 0
script = ExtResource("1_y3jks")
Speed = 300.0
MaxHealth = 400.0
CollisionShape2D = NodePath("CollisionShape2D")
WeaponComponent = NodePath("WeaponComponent")
HealthComponent = NodePath("HealthComponent")
AnimatedSprite2D = NodePath("AnimatedSprite2D")

[node name="WeaponComponent" parent="." node_paths=PackedStringArray("FireRateTimer", "BulletSpawnMarkers", "AmmunitionBar") instance=ExtResource("2_ok5fs")]
PrimaryWeaponResource = ExtResource("3_8nvt7")
BulletPhysicsLayer = 3
BulletPhysicsMask = 7
FireRateTimer = NodePath("Timer")
BulletSpawnMarkers = []
AmmunitionBar = NodePath("../AmmunitionBar")

[node name="Timer" type="Timer" parent="WeaponComponent"]

[node name="HealthComponent" parent="." node_paths=PackedStringArray("InvincibilityTimer") instance=ExtResource("4_vjyvw")]
InvincibilityTimer = NodePath("Timer")

[node name="Timer" type="Timer" parent="HealthComponent"]
wait_time = 0.6
one_shot = true

[node name="MarkerManager" parent="." node_paths=PackedStringArray("CenterMarker", "MarkersParent") instance=ExtResource("5_mws0h")]
MarkersCount = 1
MaxAngle = 15.0
CenterMarker = NodePath("../Marker2D")
MarkersParent = NodePath("..")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(0, -4)
sprite_frames = SubResource("SpriteFrames_highs")
animation = &"death"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -2.5)
shape = SubResource("RectangleShape2D_y3jks")

[node name="Marker2D" type="Marker2D" parent="."]
position = Vector2(0, -11)

[node name="HurtboxComponent" parent="." instance=ExtResource("5_uoiam")]
collision_mask = 32

[node name="CollisionShape2D" type="CollisionShape2D" parent="HurtboxComponent"]
position = Vector2(0, -2.5)
shape = SubResource("RectangleShape2D_vjyvw")

[node name="AmmunitionBar" parent="." instance=ExtResource("8_g6hfa")]
offset_left = 8.0
offset_top = -25.0
offset_right = 8.0
offset_bottom = -25.0

[connection signal="CannonAdded" from="WeaponComponent" to="MarkerManager" method="OnMarkerAdded"]
[connection signal="MarkersSpawned" from="MarkerManager" to="WeaponComponent" method="ChangeBulletSpawnMarkers"]
[connection signal="Attacked" from="HurtboxComponent" to="." method="OnAttacked"]
[connection signal="Attacked" from="HurtboxComponent" to="HealthComponent" method="TakeDamage"]
